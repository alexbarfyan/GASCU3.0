<script>
    async function sendMessage() {
        const input = document.getElementById('userInput').value;
        const responseText = document.getElementById('response');
        
        responseText.innerText = "Thinking...";
        
        try {
            // 1. Send the request
            const response = await fetch('/api/chat', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ message: input })
            });

            // 2. Check if the network request failed
            if (!response.ok) {
                throw new Error(`Server Error: ${response.status} ${response.statusText}`);
            }

            // 3. Parse the data
            const data = await response.json();
            responseText.innerText = data.reply;

        } catch (error) {
            // 4. Show the error on the screen
            console.error(error);
            responseText.innerText = "Error: " + error.message;
        }
    }
</script>
